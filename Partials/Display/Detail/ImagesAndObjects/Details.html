{namespace v=FluidTYPO3\vhs\ViewHelpers}
{namespace slub=Slub\SlubFindExtend\ViewHelpers}
{namespace s=Subugoe\Find\ViewHelpers}

<f:comment>
    Mediatype
</f:comment>
<dt class="dt-{field}">
    Medienart
</dt>
<dd class="dd-{field}">
    <f:render
        partial="Display/Field/List"
        arguments="{
                document:document,
                results:results,
                field:'listview_type',
                linkFieldContent:linkFieldContent,
                linkFacets:linkFacets
              }"/>
</dd>

<f:comment>
    Objecttype
    IF B51400  = "Anderes Objekt" OR "Anderes Konvolut" THEN B51410
</f:comment>
<v:variable.set value="{s:data.valueForKey(array:document.fields, key:'B51400')}" name="B51400" />
<v:variable.set value="{s:data.valueForKey(array:document.fields, key:'B51410')}" name="B51410" />
<f:if condition="{B51400} == 'Anderes Objekt' || {B51400} == 'Anderes Konvolut'">
    <f:then>
        <v:variable.set value="B51410" name="fieldName" />
        <v:variable.set value="{B51410}" name="fieldValue" />
    </f:then>
    <f:else>
        <v:variable.set value="B51400" name="fieldName" />
        <v:variable.set value="{B51400}" name="fieldValue" />
    </f:else>
</f:if>
<f:if condition="{fieldValue}">
    <dt class="dt-{field}">
        Objekttyp
    </dt>
    <dd class="dd-{field}">
        <f:render
            partial="Display/Field/List"
            arguments="{
                document:document,
                results:results,
                field:fieldName,
                linkFieldContent:linkFieldContent,
                linkFacets:linkFacets
              }"/>
    </dd>
</f:if>

<f:comment>
    Title
</f:comment>
<v:variable.set value="{s:data.valueForKey(array:document.fields, key:'B51800')}" name="B51800" />
<f:if condition="{B51800}">
    <dt class="dt-{field}">
        Titel
    </dt>
    <dd class="dd-{field}">
        <f:render
            partial="Display/Field/List"
            arguments="{
                document:document,
                results:results,
                field:'B51800',
                linkFieldContent:linkFieldContent,
                linkFacets:linkFacets
              }"/>
    </dd>
</f:if>

<f:comment>
    Original title
</f:comment>
<v:variable.set value="{s:data.valueForKey(array:document.fields, key:'B51801')}" name="B51801" />
<f:if condition="{B51801}">
    <dt class="dt-{field}">
        Originaltitel
    </dt>
    <dd class="dd-{field}">
        <f:render
            partial="Display/Field/List"
            arguments="{
                document:document,
                results:results,
                field:'B51801',
                linkFieldContent:linkFieldContent,
                linkFacets:linkFacets
              }"/>
    </dd>
</f:if>


<v:variable.set value="{s:data.valueForKey(array:document.fields, key:'XX_PE_P0800_PEE100')}" name="XX_PE_P0800_PEE100" />
<v:variable.set value="{s:data.valueForKey(array:document.fields, key:'XX_PE_P0800_PEU100')}" name="XX_PE_P0800_PEU100" />
<v:variable.set value="{s:data.valueForKey(array:document.fields, key:'XX_PE_P0800_PEA100')}" name="XX_PE_P0800_PEA100" />
<f:if condition="{XX_PE_P0800_PEE100} || {XX_PE_P0800_PEU100} || {XX_PE_P0800_PEA100}">
    <dt class="dt-{field}">
        Person
    </dt>
    <dd class="dd-{field}">
        <f:if condition="{XX_PE_P0800_PEE100}">
            <v:variable.set value="{s:data.valueForKey(array:document.fields, key:'XX_PE_P0800_PEE100')}" name="XX_PE_P0800_PEE100" />
            <v:variable.set value="{s:data.valueForKey(array:document.fields, key:'GFUPUE')}" name="GFUPUE" />

            <s:data.newArray
                    name="emptyArray"
                    global="1"
                    keys="{}"
                    values="{}"
            />


            <v:variable.set value="{emptyArray}" name="linkTexts" />
            <f:for each="{XX_PE_P0800_PEE100}" as="" iteration="iterator">
                <v:variable.set value="{XX_PE_P0800_PEE100.{iterator.index}} [{GFUPUE.{iterator.index}}]" name="altContent" />
                <s:data.newArray
                        name="temp"
                        global="1"
                        keys="{0: '0'}"
                        values="{0: '{XX_PE_P0800_PEE100.{iterator.index}} [{GFUPUE.{iterator.index}}]'}"
                />
                <v:variable.set value="{slub:data.mergeArrays(arrayOne:linkTexts, arrayTwo:temp)}" name="linkTexts" />
            </f:for>

            <f:render
                partial="Display/Field/List"
                arguments="{
                    document:document,
                    results:results,
                    field:'PEE100',
                    linkFieldContent:1,
                    linkFacets:linkFacets,
                    linkTexts: linkTexts
                }"/>
        </f:if>
        <f:if condition="{XX_PE_P0800_PEU100}">
            <f:render
                    partial="Display/Field/List"
                    arguments="{
                document:document,
                results:results,
                field:'PEU100',
                linkFieldContent:1,
                linkFacets:linkFacets
              }"/>
        </f:if>
        <f:if condition="{XX_PE_P0800_PEA100}">
            <f:render
                    partial="Display/Field/List"
                    arguments="{
                document:document,
                results:results,
                field:'PEA100',
                linkFieldContent:1,
                linkFacets:linkFacets
              }"/>
        </f:if>
    </dd>
</f:if>