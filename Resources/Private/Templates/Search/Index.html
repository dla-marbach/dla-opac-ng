{namespace s=Subugoe\Find\ViewHelpers}
{namespace dla=Dla\DlaOpacNg\ViewHelpers}
{namespace v=FluidTYPO3\vhs\ViewHelpers}
<f:layout name="Default"/>
<f:comment>
    Template for a the search results view.

    Sets up the page with its title, the search form, pager and result count
    information. Then displays the configured facets and a result list using the
    fields configured as standardFields.title and standardFields.snippet.
    Results are linked to the respective documents’ detail pages.

    This result display is sufficient for basic result lists.
</f:comment>
<f:section name="main">
    <s:page.title>
        <f:render partial="Components/QueryString" arguments="{query:arguments.q, facets:config.activeFacets}"/>
        –
        {config.pageTitle}
    </s:page.title>

    <f:render partial="Page/Standard" arguments="{_all}"/>


    <div class="row ctg-info-actions">
        <div class="small-6 column">
            <div class="ctg-info-text">
                <f:render partial="Components/ResultCount" arguments="{_all}"/>
            </div>
        </div>
        <div class="small-6 column ctg-ia-scnd">
            <a class="ctg-button" title="versenden"><span class="icon bel-brief01"></span></a>
            <a class="ctg-button" title="teilen"><span class="icon bel-link01"></span></a>
            <a class="ctg-button" title="exportieren"><span class="icon bel-postin"></span></a>
        </div>
    </div>

    <f:comment><div class="row ctg-info-actions active-facet-container">
        <div class="column">
            <f:for each="{config.facets}" as="facetInfo" key="facetKey">
                <f:if condition="{facetInfo.hidden}!=1">
                    <v:variable.set value="{s:data.valueForKey(array:results.components.facetset.facets, key:facetInfo.id)}" name="facetData" />
                    <f:for each="{facetData.values}" as="itemCount" key="facetTerm" iteration="iterator">
                        <f:if condition="{s:find.facetIsActive(facetID:facetInfo.id, facetTerm:facetTerm, activeFacets:config.activeFacets)}">
                            <f:link.action
                                    addQueryString="TRUE"
                                    argumentsToBeExcludedFromQueryString="{s:find.facetLinkArguments(facetID:facetInfo.id, facetTerm:facetTerm, activeFacets:config.activeFacets, mode:'remove')}"
                                    section="{settings.jumpToID}"
                                    noCacheHash="1"
                                    class=""
                                    style="text-decoration:none;"
                                    title="{f:translate(key:'remove filter %s', arguments:{0:facetTerm})}">
                                <span class="active-facets">
                                    {facetTerm}
                                    <span class="icon bel-ende01"></span>
                                </span>
                            </f:link.action>
                        </f:if>
                    </f:for>
                </f:if>
            </f:for>
        </div>
    </div></f:comment>

    <!--TYPO3SEARCH_begin-->
    <div class="row ctg-follow-content">
        <section class="small-9 column ctg-content-column">
            <div class="ctg-pager-actions">
                <f:render partial="Pager/ListPager" arguments="{_all}"/>

                <f:if condition="{f:count(subject:config.sortOptions.menu)} > 1">
                    <div class="ctg-pager-aside">
                        <f:translate key="LLL:{settings.languageRootPath}locallang-form.xml:input.sort"/>
                        <f:form.select additionalAttributes='{data-id:"c{config.uid}-sortSelect",data-sort:"1"}' name="sort" options="{config.sortOptions.menu}" value="{config.sortOptions.selected}"/>
                    </div>

                    <f:for each="{config.sortOptions.menu}" as="sortOption" key="key" iteration="iterator">
            <span
                    id="sortUri{iterator.index}"
                    style="display:none;"
                    uri='<f:uri.action
              addQueryString="TRUE"
              arguments="{sort:'{key}'}"
                        argumentsToBeExcludedFromQueryString="{0:'{config.prefixID}[page]'}"
                        section="{settings.jumpToID}"
                        noCacheHash="1">
                        </f:uri.action>'></span>
                    </f:for>
                </f:if>
            </div>

            <!-- begin results -->

            <!-- normdata -->

            <f:render partial="Display/List/FeaturedNormdata" arguments="{_all}"/>

            <!-- normdata end -->

            <f:if condition="{results.documents -> f:count()} != 0">
                <f:then>
                    <ol id="c{config.uid}-resultList" class="ctg-result-list" start="{config.counterStart}">
                        <f:for each="{results.documents}" as="document">
                            <f:render partial="Display/Result" arguments="{_all}"/>
                        </f:for>

                    </ol>
                </f:then>
                <f:else>
                    <f:render partial="Display/Static/NoHitMessage" arguments="{_all}"/>
                </f:else>
            </f:if>

            <!-- end results -->

            <div class="ctg-pager-actions">
                <f:render partial="Pager/ListPager" arguments="{_all}"/>
                <f:comment>
                    <f:if condition="{f:count(subject:config.resultCountOptions.menu)} > 1">
                        <div class="ctg-pager-aside">
                            <f:translate key="LLL:{settings.languageRootPath}locallang-form.xml:input.count"/>
                            <f:form.select id="c{config.uid}-resultCountSelect" name="count" options="{config.resultCountOptions.menu}" value="{config.resultCountOptions.selected}"/>
                        </div>
                    </f:if>
                </f:comment>
                <div class="ctg-pager-aside">
                    <f:translate key="LLL:{settings.languageRootPath}locallang-form.xml:input.count"/>
                    <f:form.select id="c{config.uid}-resultCountSelect" name="count" options="{config.resultCountOptions.menu}" value="{config.resultCountOptions.selected}"/>
                </div>
            </div>
        </section>

        <aside class="small-3 column ctg-facet-colum">
            <f:if condition="{arguments.facet}">
                <section class="ctg-facet active-facets">
                    <h3>
                        Aktive Facetten
                        <a title="schließen" data-facet-toggle="1">
                            <span class="icon bel-pfeil-o01"></span>
                        </a>
                    </h3>
                    <div class="facetList">
                        <ul>
                            <li class="active-facet-reset">
                                <f:link.action
                                        addQueryString="TRUE"
                                        argumentsToBeExcludedFromQueryString="{1: 'tx_find_find[facet]'}"
                                        section="{settings.jumpToID}"
                                        noCacheHash="1"
                                        class=""
                                        title="alle Filter zurücksetzen">
                                    <span class="icon bel-ende01"></span>
                                    alle Filter zurücksetzen
                                </f:link.action>
                            </li>
                            <f:for each="{config.facets}" as="facetInfo" key="facetKey">
                                <f:if condition="{facetInfo.hidden}!=1 OR {facetInfo.id} == 'facet_names_relations' OR {facetInfo.id} == 'facet_names_roles'">
                                    <v:variable.set value="{s:data.valueForKey(array:results.components.facetset.facets, key:facetInfo.id)}" name="facetData" />
                                    <f:for each="{facetData.values}" as="itemCount" key="facetTerm" iteration="iterator">
                                        <f:if condition="{s:find.facetIsActive(facetID:facetInfo.id, facetTerm:facetTerm, activeFacets:config.activeFacets)}">
                                            <f:comment><hr class="active-facet-hr"/></f:comment>
                                            <li>
                                                <f:link.action
                                                        addQueryString="TRUE"
                                                        argumentsToBeExcludedFromQueryString="{s:find.facetLinkArguments(facetID:facetInfo.id, facetTerm:facetTerm, activeFacets:config.activeFacets, mode:'remove')}"
                                                        section="{settings.jumpToID}"
                                                        noCacheHash="1"
                                                        class=""
                                                        title="{f:translate(key:'remove filter %s', arguments:{0:facetTerm})}">
                                                    <span class="icon bel-ende01"></span>
                                                    <f:if condition="{facetTerm} == 'true'">
                                                        <f:then>
                                                            {facetInfo.text}
                                                        </f:then>
                                                        <f:else>
                                                            <f:if condition="{facetInfo.id}=='facet_names_relations' || {facetInfo.id}=='facet_names_roles'">
                                                                <f:then>
                                                                    <dla:activeFacet text="{facetTerm}" function="decisionTree" as="output"/>
                                                                    {output}
                                                                </f:then>
                                                                <f:else>
                                                                    {facetTerm}
                                                                </f:else>
                                                            </f:if>
                                                        </f:else>
                                                    </f:if>

                                                </f:link.action>
                                            </li>
                                        </f:if>
                                    </f:for>
                                </f:if>
                            </f:for>
                            <f:if condition="{config.activeFacets.Zeit}">
                                <f:for each="{config.activeFacets.Zeit}" as="time">
                                    <li>
                                        <f:link.action
                                                addQueryString="TRUE"
                                                argumentsToBeExcludedFromQueryString="{1:'tx_find_find[facet][Zeit]'}"
                                                section="{settings.jumpToID}"
                                                noCacheHash="1"
                                                class=""
                                                title="{f:translate(key:'remove filter %s', arguments:{0:facetTerm})}">
                                            <span class="icon bel-ende01"></span>
                                            <dla:activeFacet text="{time.term}" as="output"/>
                                            {output}
                                        </f:link.action>
                                    </li>
                                </f:for>
                            </f:if>
                            <f:if condition="{config.activeFacets.NeuImKatalog}">
                                <f:for each="{config.activeFacets.NeuImKatalog}" as="newCatalogue">
                                    <li>
                                        <f:link.action
                                                addQueryString="TRUE"
                                                argumentsToBeExcludedFromQueryString="{1:'tx_find_find[facet][NeuImKatalog]'}"
                                                section="{settings.jumpToID}"
                                                noCacheHash="1"
                                                class=""
                                                title="{f:translate(key:'remove filter %s', arguments:{0:facetTerm})}">
                                            <span class="icon bel-ende01"></span>
                                            <f:if condition="{newCatalogue.term}=='RANGE NOW-7DAYS TO NOW'">
                                                <f:then>Woche</f:then>
                                                <f:else>
                                                    <f:if condition="{newCatalogue.term}=='RANGE NOW-1MONTH TO NOW'">
                                                        <f:then>Monat</f:then>
                                                        <f:else>
                                                            <f:if condition="{newCatalogue.term}=='RANGE NOW-3MONTH TO NOW'">
                                                                <f:then>Quartal</f:then>
                                                                <f:else>
                                                                    <f:if condition="{newCatalogue.term}=='RANGE NOW-6MONTH TO NOW'">
                                                                        <f:then>Halbjahr</f:then>
                                                                        <f:else>
                                                                            <f:if condition="{newCatalogue.term}=='RANGE NOW-12MONTH TO NOW'">
                                                                                <f:then>Jahr</f:then>
                                                                                <f:else> - </f:else>
                                                                            </f:if>
                                                                        </f:else>
                                                                    </f:if>
                                                                </f:else>
                                                            </f:if>
                                                        </f:else>
                                                    </f:if>
                                                </f:else>
                                            </f:if>
                                        </f:link.action>
                                    </li>
                                </f:for>
                            </f:if>
                        </ul>
                    </div>
                </section>
            </f:if>

            <f:render partial="Facets/Facets" arguments="{_all}"/>

            <f:render partial="Display/Static/RightColumn" arguments="{_all}"/>

            <section class="ctg-facet-other">
                <h3><f:translate key='Andere Fundorte' extensionName='dla_opac_ng'/> (?)<a title="<f:translate key='schließen' extensionName='dla_opac_ng'/>"><span class="icon bel-pfeil-o01"></span></a></h3>
                <ul>
                    <li><a title=""><span class="icon bel-link03"></span></a><a title="">Andere Fundorte (?)</a></li>
                    <li><a title=""><span class="icon bel-link03"></span></a><a title="">Kalliope (?)</a></li>
                    <li><a title=""><span class="icon bel-link03"></span></a><a title="">Wikipedia (?)</a></li>
                </ul>
            </section>
        </aside>
    </div>
    <!--TYPO3SEARCH_end-->

</f:section>
