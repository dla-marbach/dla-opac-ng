{namespace v=FluidTYPO3\vhs\ViewHelpers}
{namespace slub=Slub\SlubFindExtend\ViewHelpers}
{namespace dla=Dla\DlaOpacNg\ViewHelpers}
{namespace s=Subugoe\Find\ViewHelpers}


<f:render partial="Display/Detail/Library/Mediatype" arguments="{results:results, document:document}" />
<f:render partial="Display/Detail/Library/Title" arguments="{results:results, document:document}" />
<f:render partial="Display/Detail/Library/Author" arguments="{results:results, document:document}" />
<f:render partial="Display/Detail/Library/Involved" arguments="{results:results, document:document}" />
<f:render partial="Display/Detail/Library/Appeared" arguments="{results:results, document:document}" />
<f:render partial="Display/Detail/Library/PublicationHistory" arguments="{results:results, document:document}" />
<f:render partial="Display/Detail/Library/Edition" arguments="{results:results, document:document}" />
<f:render partial="Display/Detail/Library/Scope" arguments="{results:results, document:document}" />
<f:render partial="Display/Detail/Library/PhysicalDescription" arguments="{results:results, document:document}" />
<f:render partial="Display/Detail/Library/ISBN" arguments="{results:results, document:document}" />
<f:render partial="Display/Detail/Library/ISSN" arguments="{results:results, document:document}" />

<dt class="dt-{field}">
    E-ISSN
</dt>
<dd class="dd-{field}">
    Baustelle
</dd>

<f:render partial="Display/Detail/Library/ZDBID" arguments="{results:results, document:document}" />
<f:render partial="Display/Detail/Library/PartOf" arguments="{results:results, document:document}" />
<f:render partial="Display/Detail/Library/ContainedIn" arguments="{results:results, document:document}" />
<f:render partial="Display/Detail/Library/Remarks" arguments="{results:results, document:document}" />
<f:render partial="Display/Detail/Library/Usage" arguments="{results:results, document:document}" />
<f:render partial="Display/Detail/Library/Signature" arguments="{results:results, document:document}" />
<f:render partial="Display/Detail/Library/Provenance" arguments="{results:results, document:document}" />


<dt class="dt-{field}">
    Sendeangaben
</dt>
<dd class="dd-{field}">
    Baustelle
</dd>

<f:render partial="Display/Detail/Library/DigitalObject" arguments="{results:results, document:document}" />
<f:render partial="Display/Detail/Library/WorkFull" arguments="{results:results, document:document}" />
<f:render partial="Display/Detail/Library/PartOfWorkFull" arguments="{results:results, document:document}" />
<f:render partial="Display/Detail/Library/MoreTitlesFull" arguments="{results:results, document:document}" />
<f:render partial="Display/Detail/Library/LanguageFull" arguments="{results:results, document:document}" />
<f:render partial="Display/Detail/Library/OriginalLanguageFull" arguments="{results:results, document:document}" />
<f:render partial="Display/Detail/Library/ScaleFull" arguments="{results:results, document:document}" />


<v:variable.set value="{s:data.valueForKey(array:document.fields, key:'A0431')}" name="A0431" />

<dt class="dt-{field}">
    Register
</dt>
<dd class="dd-{field}">
    <f:if condition="{A0431}">
        <f:then>
            <f:render
                    partial="Display/Field/List"
                    arguments="{
                        document:document,
                        results:results,
                        field:'A0431',
                        linkFieldContent:1,
                        linkFacets:linkFacets
                      }"/>
        </f:then>
        <f:else>
            -
        </f:else>
    </f:if>
</dd>


<dla:data.valueForKeyFiltered
        key="A0501"
        filterKey="AM501"
        filterValues="{0:'517n'}"
        fields="{document.fields}"
        as="A0501" />

<dt class="dt-{field}">
    Enthält
</dt>
<dd class="dd-{field}">
    <f:if condition="{A0501}">
        <f:then>
            <f:for each="{A0501}" as="item" iteration="iterator">
                {item}<br />
            </f:for>
        </f:then>
        <f:else>
            -
        </f:else>
    </f:if>
</dd>


<dt class="dt-{field}">
    Anmerkungen
</dt>
<dd class="dd-{field}">
    <v:variable.set value="{s:data.valueForKey(array:document.fields, key:'A0654')}" name="A0654" />
    <f:if condition="{A0654}">
        <f:then>
            <f:render
                    partial="Display/Field/List"
                    arguments="{
                        document:document,
                        results:results,
                        field:'A0654',
                        linkFieldContent:linkFieldContent,
                        linkFacets:linkFacets
                      }"/>
        </f:then>
        <f:else>
        </f:else>
    </f:if>


    <f:comment>
        Anmerkungen (Hochschulschrift)
    </f:comment>
    <dla:data.valueForKeyFiltered
            key="A0501"
            filterKey="AM501"
            filterValues="{0:'519'}"
            fields="{document.fields}"
            as="A0501_a" />

    <dla:data.joinFields
            fieldNames="{0:'GHSART',1:'GHSNAM',3:'GHSDAT'}"
            fieldWraps="{0:'%s',1:', %s',2:', %s'}"
            fields="{document.fields}"
            as="altTextA0501"
    />
    <f:if condition="{A0501_a} || {altTextA0501}">
        <f:then>
            <f:if condition="{A0501_a}">
                <f:then>
                    <f:for each="{A0501_a}" as="item" iteration="iterator">
                        {item}<br />
                    </f:for>
                </f:then>
                <f:else>
                    <f:for each="{altTextA0501}" as="item" iteration="iterator">
                        {item}<br />
                    </f:for>
                </f:else>
            </f:if>
        </f:then>
        <f:else>
        </f:else>
    </f:if>

    <f:comment>
        Anmerkungen (Diverse A0501)
    </f:comment>
    <dla:data.valueForKeyFiltered
            key="A0501"
            filterKey="AM501"
            filterValues="{0:'526n',1:'517n',2:'519'}"
            negateFilter="true"
            fields="{document.fields}"
            as="A0501" />
    <f:if condition="{A0501}">
        <f:then>
            <f:for each="{A0501}" as="item" iteration="iterator">
                {item}<br />
            </f:for>
        </f:then>
        <f:else>
        </f:else>
    </f:if>

    <f:if condition="{A0654} || {A0501_a} || {altTextA0501} || {A0501}">
        <f:then>
        </f:then>
        <f:else>
            -
        </f:else>
    </f:if>
</dd>


<v:variable.set value="{s:data.valueForKey(array:document.fields, key:'XX_AK_TITREG_GWKEY')}" name="XX_AK_TITREG_GWKEY" />

<dt class="dt-{field}">
    Werk
</dt>
<dd class="dd-{field}">
    <f:if condition="{XX_AK_TITREG_GWKEY}">
        <f:then>
            <f:render
                    partial="Display/Field/List"
                    arguments="{
            document:document,
            results:results,
            field:'GWKEY',
            linkFieldContent:1,
            linkFacets:linkFacets,
            linkTexts:XX_AK_TITREG_GWKEY
          }"/>
        </f:then>
        <f:else>
            -
        </f:else>
    </f:if>
</dd>



<v:variable.set value="{s:data.valueForKey(array:document.fields, key:'XX_AK_TITREG_AKE526')}" name="XX_AK_TITREG_AKE526" />

<dt class="dt-{field}">
    Teilwerke
</dt>
<dd class="dd-{field}">
    <f:if condition="{XX_AK_TITREG_AKE526}">
        <f:then>
            <f:render
                    partial="Display/Field/List"
                    arguments="{
            document:document,
            results:results,
            field:'XX_AK_TITREG_AKE526',
            linkFieldContent:linkFieldContent,
            linkFacets:linkFacets
          }"/>
        </f:then>
        <f:else>
            -
        </f:else>
    </f:if>
</dd>


<f:comment>
Für die Feldbenennung:
AKYTXT

    Für den Feldinhalt
    XX_AK_TITREG_AKY526


        Die Datensatzverknüpfung erfolgt nur in eine Richtung, die
    AKYTXT
    wird nicht in beiden Sätzen belegt,
        für die Anzeige im verknüpten Satz müssen die Werte aus
    IND526
    herangezogen werden,
        dafür wurde eine Mappingtabelle. Die Lösung sollte so implementiert werden,
        dass sie vom DLA weiter einfach weitergepflegt werden kann.
    </f:comment>

<v:variable.set value="{s:data.valueForKey(array:document.fields, key:'AKYTXT')}" name="AKYTXT" />
<v:variable.set value="{s:data.valueForKey(array:document.fields, key:'XX_AK_TITREG_AKY526')}" name="XX_AK_TITREG_AKY526" />

    <f:for each="{AKYTXT}" as="labelItem" iteration="labelIterator">
        <dt class="dt-{field}">
            {labelItem}
        </dt>
        <dd class="dd-{field}">
            {XX_AK_TITREG_AKY526.{labelIterator.index}}
        </dd>
    </f:for>
<f:if condition="{XX_AK_TITREG_AKY526}">
</f:if>


<v:variable.set value="{s:data.valueForKey(array:document.fields, key:'XX_SE_REGTIT_SYNKEY')}" name="XX_SE_REGTIT_SYNKEY" />
<dt class="dt-{field}">
    Inhalt
</dt>
<dd class="dd-{field}">
    <f:if condition="{XX_SE_REGTIT_SYNKEY}">
        <f:then>
            <f:render
                    partial="Display/Field/List"
                    arguments="{
            document:document,
            results:results,
            field:'SYNKEY',
            linkFieldContent:1,
            linkFacets:linkFacets,
            linkTexts:XX_SE_REGTIT_SYNKEY
            }"/>
        </f:then>
        <f:else>
            -
        </f:else>
    </f:if>
</dd>


<v:variable.set value="{s:data.valueForKey(array:document.fields, key:'A0712')}" name="A0712" />
<dt class="dt-{field}">
    Inhalt
</dt>
<dd class="dd-{field}">
    <f:if condition="{A0712}">
        <f:then>
            <f:render
                    partial="Display/Field/List"
                    arguments="{
            document:document,
            results:results,
            field:'A0712',
            linkFieldContent:linkFieldContent,
            linkFacets:linkFacets
            }"/>
        </f:then>
        <f:else>
            -
        </f:else>
    </f:if>
    </dd>


<v:variable.set value="{s:data.valueForKey(array:document.fields, key:'POS114')}" name="POS114" />
<dt class="dt-{field}">
    Inhalt
</dt>
<dd class="dd-{field}">
    <f:if condition="{POS114}">
        <f:then>
            <f:render
                    partial="Display/Field/List"
                    arguments="{
            document:document,
            results:results,
            field:'POS114',
            linkFieldContent:linkFieldContent,
            linkFacets:linkFacets
            }"/>
        </f:then>
        <f:else>
            -
        </f:else>
    </f:if>
</dd>

<f:comment>
    Inhalt BEMURL
</f:comment>

<v:variable.set value="{s:data.valueForKey(array:document.fields, key:'XX_MM_MOTITL_INDKEY')}" name="XX_MM_MOTITL_INDKEY" />
<v:variable.set value="{0:'Rezension',
    1:'Inhaltstext',
    2:'Inhaltsverzeichnis'
}" name="bemurlValues"/>

<dla:data.valueForKeyFiltered key="AURL" filterKey="BEMURL" filterValues="{bemurlValues}" fields="{document.fields}" as="AURL" />
<dla:data.valueForKeyFiltered key="BEMURL" filterKey="BEMURL" filterValues="{bemurlValues}" fields="{document.fields}" as="BEMURL" />

<dla:data.joinFieldArrays
        arrays="{0:'{AURL}',1:'{BEMURL}'}"
        fieldWraps="{0:'%s',1:'(%s)'}"
        as="contentBemurl"
/>
<v:variable.set value="{s:data.valueForKey(array:document.fields, key:'BEMURL')}" name="BEMURL" />
<v:variable.set value="{s:data.valueForKey(array:document.fields, key:'AURL')}" name="AURL" />

<dt class="dt-{field}">
    Inhalt
</dt>
<dd class="dd-{field}">
    <f:if condition="{contentBemurl}">
        <f:then>
            <f:for each="{contentBemurl}" as="item" iteration="iterator">
                <a href="{AURL.{iterator.index}}">{item}</a><br />
            </f:for>
        </f:then>
        <f:else>
        </f:else>
    </f:if>
</dd>


<v:variable.set value="{s:data.valueForKey(array:document.fields, key:'A0711')}" name="A0711>" />
<v:variable.set value="{s:data.valueForKey(array:document.fields, key:'FREITX')}" name="FREITX" />
<v:variable.set value="{s:data.valueForKey(array:document.fields, key:'XX_SE_REGTIT_SYNKEY')}" name="XX_SE_REGTIT_SYNKEY" />
<dt class="dt-{field}">
    Bibliographie
</dt>
<dd class="dd-{field}">
    <f:if condition="{A0711} || {AURL} || {XX_SE_REGTIT_SYNKEY}">
        <f:then>
            <f:render
                    partial="Display/Field/List"
                    arguments="{
            document:document,
            results:results,
            field:'A0711',
            linkFieldContent:linkFieldContent,
            linkFacets:linkFacets
            }"/>

            <f:render
                    partial="Display/Field/List"
                    arguments="{
            document:document,
            results:results,
            field:'AURL',
            linkFieldContent:linkFieldContent,
            linkFacets:linkFacets
            }"/>

            <f:render
                partial="Display/Field/List"
                arguments="{
            document:document,
            results:results,
            field:'XX_SE_REGTIT_SYNKEY',
            linkFieldContent:linkFieldContent,
            linkFacets:linkFacets
            }"/>
        </f:then>
        <f:else>
            -
        </f:else>
    </f:if>
</dd>
